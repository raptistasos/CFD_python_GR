
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Η εξίσωση Διάχυσης &#8212; Εισαγωγή στην Υπολογιστική Ρευστοδυναμική μέσω της Γλώσσας Προγραμματισμού Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter4';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Οι εξισώσεις Laplace και Poisson" href="Chapter5.html" />
    <link rel="prev" title="Βασικές αριθμητικές μέθοδοι για προβλήματα Ρευστοδυναμικής" href="Chapter3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Εισαγωγή στην Υπολογιστική Ρευστοδυναμική μέσω της Γλώσσας Προγραμματισμού Python - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Εισαγωγή στην Υπολογιστική Ρευστοδυναμική μέσω της Γλώσσας Προγραμματισμού Python - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Περίληψη
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1.html">Εισαγωγή στη γλώσσα προγραμματισμού Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter2.html">Εισαγωγή στις Αριθμητικές Μεθόδους</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter3.html">Βασικές αριθμητικές μέθοδοι για προβλήματα Ρευστοδυναμικής</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Η εξίσωση Διάχυσης</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter5.html">Οι εξισώσεις Laplace και Poisson</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter6.html">Η Εξίσωση Μεταφοράς</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter7.html">Η Εξίσωση Μεταφοράς - Διάχυσης</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter8.html">Η εξίσωση του Burgers και η εξίσωση των Korteweg-de Vries (KdV)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter9.html">Οι Εξισώσεις των Navier και Stokes</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">Βιβλιογραφία</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/raptistasos/CFD_python_GR/master?urlpath=tree/Chapter4.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://github.com/raptistasos/CFD_python_GR" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Chapter4.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Η εξίσωση Διάχυσης</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Περίληψη</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Η εξίσωση διάχυσης σε μία χωρική διάσταση</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Το πρόβλημα αρχικών-συνοριακών τιμών για την εξίσωση διάχυσης σε μία διάσταση</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crank-nicolson">Το σχήμα των Crank-Nicolson</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theta">Ο κανόνας του <span class="math notranslate nohighlight">\(\theta\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#du-fort-frankel">Ο τύπος των Du Fort-Frankel και η μέθοδος εμπρόσθιων διαφορών</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Επέκταση στις δύο διαστάσεις</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>Η εξίσωση Διάχυσης<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<section id="id2">
<h2>Περίληψη<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>Στην πρώτη ενότητα αυτού του κεφαλαίου η μεθοδολογία ξεκινά με την απλούστερη Μ.Δ.Ε., την εξίσωση διάχυσης, που αποτελεί το απλούστερο πρόβλημα παραβολικού τύπου <span id="id3">[<a class="reference internal" href="zreferences.html#id12" title="Νικόλαος Καφούσιας. Υπολογιστική ρευστοδυναμική ΙΙ. Εκδόσεις Πανεπιστημίου Πάτρας, Πάτρα, 2001.">Καφούσιας, 2001</a>]</span>. Περιγράφεται το πρόβλημα αρχικών-συνοριακών τιμών για την εξίσωση διάχυσης σε μία διάσταση. Ακολουθεί η άμεση και πεπλεγμένη μέθοδος του Euler και το σχήμα των Crank-Nicolson. Εισάγεται ο κανόνας του <span class="math notranslate nohighlight">\(\theta\)</span> καθώς και το σχήμα των Dufort-Frankel. Ακολουθεί η επέκταση της μεθοδολογίας στις δύο διαστάσεις. Το κεφάλαιο κλείνει με αναλυτικές εφαρμογές και ασκήσεις προς λύση με υπόδειξη για τα βασικά βήματα επίλυσης τους.</p>
<p><strong>Προαπαιτούμενη γνώση</strong>: Βασικές γνώσεις Συνήθων/Μερικών Διαφορικών Εξισώσεων και Αριθμητικής Ανάλυσης.</p>
</section>
<section id="id4">
<h2>Η εξίσωση διάχυσης σε μία χωρική διάσταση<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>Το κεφάλαιο ξεκινά με την αριθμητική μεθοδολογία για την απλούστερη Μ.Δ.Ε., τη μονοδιάστατη εξίσωση διάχυσης. Η χρονοεξαρτώμενη αυτή εξίσωση είναι παραβολικού τύπου και δίνεται στην παρακάτω μορφή,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-1">
<span class="eqno">(99)<a class="headerlink" href="#equation-eq-k4-1" title="Link to this equation">#</a></span>\[
\frac{\partial u}{\partial t} = d \, \frac{\partial^2 u}{\partial x^2},
\]</div>
<p>όπου <span class="math notranslate nohighlight">\(u(x,t)\)</span> είναι η άγνωστη συνάρτηση ή η εξαρτημένη μεταβλητή που εξαρτάται από τη χωρική μεταβλητή <span class="math notranslate nohighlight">\(x\)</span> και τη χρονική μεταβλητή <span class="math notranslate nohighlight">\(t\)</span>. Ο συντελεστής <span class="math notranslate nohighlight">\(d\)</span> καλείται συντελεστής διάχυσης και καθορίζει πόσο γρήγορα διαχέεται ή μεταβάλλεται η συνάρτηση <span class="math notranslate nohighlight">\(u\)</span> στο χωρίο ολοκλήρωσης, <span class="math notranslate nohighlight">\(\Omega\)</span>. Σε σύγκριση με την κυματική εξίσωση, <span class="math notranslate nohighlight">\(u_{tt} = c^2 \, u_{xx}\)</span>, η οποία μοιάζει με την εξίσωση <a class="reference internal" href="#equation-eq-k4-1">(99)</a>, η εξίσωση διάχυσης διαθέτει λύσεις που είναι πολύ διαφορετικές από αυτές της κυματικής εξίσωσης, η οποία είναι υπερβολικού τύπου. Ως αποτέλεσμα, η εξίσωση διάχυσης έχει και αρκετά διαφορετικές απαιτήσεις σε σχέση με την κυματική εξίσωση στις αριθμητικές μεθόδους λόγω της φύσης της εξίσωσης και των προβλημάτων που περιγράφει.</p>
<p>Συγκεκριμένα, τα προβλήματα διάχυσης μπορεί να παρουσιάσουν ταχεία αλλαγή στην αρχή, αλλά στη συνέχεια η εξέλιξη της <span class="math notranslate nohighlight">\(u\)</span> γίνεται όλο και πιο αργή. Η λύση είναι συνήθως πολύ ομαλή, και μετά από κάποιο χρονικό διάστημα, δεν μπορεί κανείς να αναγνωρίσει το αρχικό σχήμα της <span class="math notranslate nohighlight">\(u\)</span>. Αυτό έρχεται σε αντίθεση με τις λύσεις της κυματικής εξίσωσης όπου διατηρείται το αρχικό σχήμα, δηλαδή η λύση είναι μια κινούμενη αρχική συνθήκη, ένα αρχικό κύμα που μεταφέρεται στο χώρο. Η κλασική εξίσωση κύματος <span class="math notranslate nohighlight">\(u_{tt} = c^2 \, u_{xx}\)</span> έχει λύσεις που διαδίδονται με ταχύτητα <span class="math notranslate nohighlight">\(c\)</span> για πάντα, χωρίς να αλλάζει το σχήμα του κύματος, ενώ η εξίσωση διάχυσης συγκλίνει σε μια σταθερή λύση <span class="math notranslate nohighlight">\(\bar u(x)\)</span> καθώς το <span class="math notranslate nohighlight">\(t \to \infty\)</span>. Σε αυτό το όριο, <span class="math notranslate nohighlight">\(u_t = 0\)</span>, και για την <span class="math notranslate nohighlight">\(\bar u\)</span> ισχύει ότι <span class="math notranslate nohighlight">\(\bar u''(x) = 0\)</span>. Αυτό το όριο της εξίσωσης διάχυσης περιγράφεται από την εξίσωση του Laplace, ελλειπτικού τύπου, και προκύπτει σε ένα πολύ ευρύ φάσμα εφαρμογών σε όλες τις επιστήμες και στη Ρευστομηχανική.</p>
<p>Είναι εφικτό να λυθεί αριθμητικά η εξίσωση <a class="reference internal" href="#equation-eq-k4-1">(99)</a> και να βρεθεί η λύση της <span class="math notranslate nohighlight">\(u(x,t)\)</span>, με χρήση ενός άμεσου ή εκπεφρασμένου σχήματος, αλλά οι περιορισμοί του χρονικού βήματος είναι πολύ δεσμευτικοί σε σχέση με ένα πεπλεγμένο αριθμητικό σχήμα. Δεδομένου ότι η λύση <span class="math notranslate nohighlight">\(u\)</span> της εξίσωσης διάχυσης είναι πολύ ομαλή και αλλάζει αργά καθώς το <span class="math notranslate nohighlight">\(t \to \infty\)</span>, τα μικρά χρονικά βήματα δεν είναι βολικά και δεν απαιτούνται από την ακρίβεια καθώς η διαδικασία επίλυσης της εξίσωσης διάχυσης συγκλίνει σε μια σταθερή κατάσταση (steady state). Όλα αυτά τα θέματα θα μας απασχολήσουν στις επόμενες ενότητες.</p>
</section>
<section id="id5">
<h2>Το πρόβλημα αρχικών-συνοριακών τιμών για την εξίσωση διάχυσης σε μία διάσταση<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>Όπως αναφέρθηκε στην προηγούμενη ενότητα, η εξίσωση διάχυσης είναι παραβολικού τύπου, που σημαίνει ότι για να επιλυθεί η εξίσωση και να βρεθεί μια μοναδική μερική λύση της χρειάζεται να διαθέτουμε τόσο αρχικές όσο και συνοριακές συνθήκες. Η εξίσωση διάχυσης ξεκινάει με μία αρχική συνθήκη <span class="math notranslate nohighlight">\(u(x,0) = f(x)\)</span>, όπου το <span class="math notranslate nohighlight">\(f\)</span> είναι μια συνεχής συνάρτηση του χώρου <span class="math notranslate nohighlight">\(\Omega = [0, L]\)</span>. Απαιτείται μία συνοριακή συνθήκη σε κάθε σύνορο του χωρίου, που σε ένα μονοδιάστατο χωρίο όπως το <span class="math notranslate nohighlight">\(\Omega\)</span> σημαίνει ότι πρέπει να είναι γνωστή η <span class="math notranslate nohighlight">\(u\)</span> ή η <span class="math notranslate nohighlight">\(u_x\)</span> ή κάποιος συνδυασμός τους στα συνοριακά σημεία, <span class="math notranslate nohighlight">\(0\)</span> και <span class="math notranslate nohighlight">\(L\)</span>. Ξεκινάμε με την απλούστερη συνοριακή συνθήκη, <span class="math notranslate nohighlight">\(u = 0\)</span> (συνθήκη Dirichlet, για την άγνωστη συνάρτηση). Το πλήρες πρόβλημα διάχυσης αρχικών-συνοριακών τιμών, σε μία διάσταση του χώρου μπορεί να διατυπωθεί ως,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-2">
<span class="eqno">(100)<a class="headerlink" href="#equation-eq-k4-2" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\frac{\partial u}{\partial t} &amp;= d \, \frac{\partial^2 u}{\partial x^2}, \quad (x,t) \in (0,L) \times (0,T], \\[1em]
u(x, 0) &amp;= f(x), \quad x \in [0, L], \\[1em]
u(0, t) &amp;= u(L, t) = 0, \quad t&gt; 0.
\end{aligned}
\end{split}\]</div>
<p>Η εξίσωση <a class="reference internal" href="#equation-eq-k4-2">(100)</a> είναι γνωστή ως μονοδιάστατη εξίσωση διάχυσης, και συχνά αναφέρεται ως εξίσωση θερμότητας (heat equation). Με μία χρονική παράγωγο πρώτης τάξης, χρειάζεται μόνο μία αρχική συνθήκη, ενώ η παράγωγος δεύτερης τάξης στο διάστημα οδηγεί σε αναζήτηση δύο συνοριακών συνθηκών <span id="id6">[<a class="reference internal" href="zreferences.html#id12" title="Νικόλαος Καφούσιας. Υπολογιστική ρευστοδυναμική ΙΙ. Εκδόσεις Πανεπιστημίου Πάτρας, Πάτρα, 2001.">Καφούσιας, 2001</a>]</span>. Πρέπει επίσης να δοθεί η παράμετρος <span class="math notranslate nohighlight">\(d\)</span>, δηλαδή ο συντελεστής διάχυσης.</p>
<p>Οι εξισώσεις διάχυσης όπως η <a class="reference internal" href="#equation-eq-k4-2">(100)</a> έχουν ένα ευρύ φάσμα εφαρμογών στις επιστήμες της Φυσικής, της Βιολογίας, των Οικονομικών και στη Ρευστομηχανική. Μία από τις πιο κοινές εφαρμογές είναι η διάδοση θερμότητας, όπου η <span class="math notranslate nohighlight">\(u(x,t)\)</span> μπορεί να αντιπροσωπεύει τη θερμοκρασία στο σημείο <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(x \in (0, L)\)</span> και τη χρονική στιγμή <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(t \in (0, T]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gauss</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Συνάρτηση Gauss</span>
<span class="sd">    a: ύψος της κορυφής της καμπύλης</span>
<span class="sd">    b: θέση της κορυφής της καμπύλης</span>
<span class="sd">    c: τυπική απόκλιση</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">plug_profile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">solve_diffusion1D_FE</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Επιλύει τη μονοδιάστατη εξίσωση διάχυσης με το άμεσο σχήμα Euler (Forward Euler, FE) </span>
<span class="sd">    θεωρώντας ομογενείς, μηδενικές, συνοριακές συνθήκες.</span>
<span class="sd">    L: μήκος χωρίου στη διάσταση x</span>
<span class="sd">    Τ: τελική χρονική στιγμή</span>
<span class="sd">    dx: χωρικό βήμα</span>
<span class="sd">    dt: χρονικό βήμα</span>
<span class="sd">    d: συντελεστής διάχυσης</span>
<span class="sd">    I: συνάρτηση που επιστρέφει την αρχική συνθήκη (π.χ. gauss ή plug_profile).</span>
<span class="sd">    *args: μέσω της λέξης κλειδί *args δηλώνεται δυναμικός αριθμός επιπλέον ορισμάτων.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="c1"># πεδίο ορισμού - υπολογιστικό πλέγμα</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">plot_freq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nsteps</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    
    <span class="n">u0</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="c1"># αρχική συνθήκη. Το πρώτο όρισμα της συνάρτησης (xs) είναι το πεδίο ορισμού και τα</span>
    <span class="c1">#υπό΄λοιπα ορίσματα (αδιευκρίνιστα εκ των προτέρων) εισάγονται μέσω της λέξης κλειδί *args.</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="c1"># τρέχον χρονικό βήμα</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
       
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span>  <span class="ow">in</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="c1"># η επανάληψη δεν περιλαμβάνει το πρώτο και τελευταίο σημείο του πεδίου ορισμού τα οποία καθορίζονται</span>
            <span class="c1"># από τις συνοριακές συνθήκες.</span>

            <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="o">*</span><span class="p">(</span><span class="n">u0</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">u0</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">plot_freq</span> == 0:
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="n">n</span><span class="o">*</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="c1"># επιβολή συνοριακών συνθηκών</span>
        <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  
        <span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">u0</span> <span class="o">=</span> <span class="n">u</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Στο <a class="reference internal" href="#fig-explicit-euler1"><span class="std std-numref">Σχήμα 11</span></a> παρουσιάζεται ένα παράδειγμα επίλυσης της μονοδιάστατης εξίσωσης διάχυσης με άμεσο σχήμα Euler, όπου η αρχική συνθήκη ορίζεται μέσω της συνάρτησης gauss.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">solve_diffusion1D_FE</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">gauss</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-explicit-euler1">
<a class="reference internal image-reference" href="_images/explicit_Euler_1.svg"><img alt="_images/explicit_Euler_1.svg" src="_images/explicit_Euler_1.svg" style="width: 505.70000000000005px; height: 261.3px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Eπίλυση της μονοδιάστατης εξίσωσης διάχυσης με άμεσο σχήμα Euler. Η αρχική συνθήκη ορίζεται μέσω της συνάρτησης gauss.</span><a class="headerlink" href="#fig-explicit-euler1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Στο <a class="reference internal" href="#fig-explicit-euler2"><span class="std std-numref">Σχήμα 12</span></a> παρουσιάζεται ένα παράδειγμα επίλυσης της μονοδιάστατης εξίσωσης διάχυσης με άμεσο σχήμα Euler, όπου η αρχική συνθήκη ορίζεται μέσω της συνάρτησης plug_profile.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">solve_diffusion1D_FE</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">plug_profile</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-explicit-euler2">
<a class="reference internal image-reference" href="_images/explicit_Euler_2.svg"><img alt="_images/explicit_Euler_2.svg" src="_images/explicit_Euler_2.svg" style="width: 516.1px; height: 261.3px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Eπίλυση της μονοδιάστατης εξίσωσης διάχυσης με άμεσο σχήμα Euler. Η αρχική συνθήκη ορίζεται μέσω της συνάρτησης plug_profile.</span><a class="headerlink" href="#fig-explicit-euler2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Εφαρμόζοντας οπίσθιες πεπερασμένες διαφορές για το χρόνο και κεντρικές πεπερασμένες διαφορές για το χώρο, καταλήγουμε σε ένα διαφορετικό αριθμητικό σχήμα το οποίο είναι πεπλεγμένο. Το αριθμητικό σχήμα τώρα είναι,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-7">
<span class="eqno">(101)<a class="headerlink" href="#equation-eq-k4-7" title="Link to this equation">#</a></span>\[
\frac{u_i^{n} - u_i^{n-1}}{\Delta t} = d \, \frac{u_{i+1}^{n} - 2 \, u_i^n + u_{i-1}^n}{\Delta x^2}.
\]</div>
<p>Σε αυτό το αριθμητικό σχήμα η ποσότητα <span class="math notranslate nohighlight">\(u_i^{n-1}\)</span> είναι γνωστή, αλλά όλες οι υπόλοιπες ποσότητες στο νέο χρονικό βήμα <span class="math notranslate nohighlight">\(n\)</span> είναι άγνωστες. Σε αυτή την περίπτωση δεν είναι δυνατόν να λύσουμε ως προς την άγνωστη συνάρτηση στο σημείο <span class="math notranslate nohighlight">\((i, n)\)</span>, δηλαδή για την <span class="math notranslate nohighlight">\(u_i^n\)</span>, επειδή οι τιμές της <span class="math notranslate nohighlight">\(u\)</span> στα γειτονικά σημεία, <span class="math notranslate nohighlight">\(u_{i-1}^n\)</span> και <span class="math notranslate nohighlight">\(u_{i+1}^n\)</span>, είναι επίσης άγνωστες. Ένα τέτοιο αριθμητικό σχήμα λέγεται πεπλεγμένο, επειδή εμπλέκει περισσότερες από μία άγνωστες τιμές της συνάρτησης, <span class="math notranslate nohighlight">\(u\)</span> στα γειτονικά σημεία.</p>
<p>Το αριθμητικό σχήμα της εξίσωσης <a class="reference internal" href="#equation-eq-k4-7">(101)</a> δίνει ένα πεπλεγμένο σύστημα <span class="math notranslate nohighlight">\((N_x - 1) \times (N_x - 1)\)</span> αλγεβρικών εξισώσεων για τις άγνωστες τιμές <span class="math notranslate nohighlight">\(u_i^n\)</span> της συνάρτησης στα εσωτερικά χωρικά σημεία του πλέγματος, <span class="math notranslate nohighlight">\(i = 1, ..., N_x - 1\)</span>. Συγκεντρώνοντας τους αγνώστους στο αριστερό μέλος της εξίσωσης, μπορούμε να γράψουμε,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-8">
<span class="eqno">(102)<a class="headerlink" href="#equation-eq-k4-8" title="Link to this equation">#</a></span>\[
- F \, u_{i-1}^n + (1 + 2 F) \, u_i^{n} - F \, u_{i+1}^{n} = u_i^{n-1},
\]</div>
<p>για <span class="math notranslate nohighlight">\(i = 1, ..., N_x - 1\)</span> και η παράμετρος <span class="math notranslate nohighlight">\(F = \frac{d \, \Delta t}{\Delta x^2}\)</span> καλείται αριθμός Fourier του υπολογιστικού πλέγματος (mesh Fourier number).
Εφαρμόζοντας τις αντίστοιχες συνοριακές συνθήκες για το πρόβλημα αυτό, καταλήγουμε σε ένα σύστημα αλγεβρικών εξισώσεων της μορφής, <span class="math notranslate nohighlight">\(A \, \mathbf{u} = \mathbf{b}\)</span>, όπου <span class="math notranslate nohighlight">\(\mathbf{u} = (u_0^n, ..., u_{N_x}^n)^T\)</span> και ο πίνακας <span class="math notranslate nohighlight">\(A\)</span> έχει την εξής μορφή:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \begin{bmatrix}
   a_{0,0} &amp; a_{0,1} &amp; 0             &amp; \dots          &amp; 0                 \\
   a_{1,0} &amp; a_{1,1} &amp; a_{1,2}   &amp; \dots          &amp; 0                 \\
   0           &amp; a_{2,1} &amp; a_{2,2}   &amp; a_{2,3} &amp; \dots              \\
   \vdots    &amp; \ddots  &amp;  \ddots    &amp;  \ddots     &amp; \vdots            \\
   0           &amp; \dots  &amp; a_{N_x,N_{x-1}} &amp; a_{N_x,N_x}
\end{bmatrix}
\end{split}\]</div>
<p>Ο πίνακας <span class="math notranslate nohighlight">\(A\)</span> είναι αραιός (δηλαδή έχει πολλά μηδενικά στοιχεία), συμμετρικός και τριδιαγώνιος. Έχει δηλαδή πολύ καλές ιδιότητες. Είναι, επίσης, θετικά ορισμένος αφού τα μη μηδενικά στοιχεία δίνονται από τις σχέσεις,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-9">
<span class="eqno">(103)<a class="headerlink" href="#equation-eq-k4-9" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
a_{i,i-1} &amp;= - F, \\
a_{i,i}   &amp;= 1 + 2 \, F, \\
a_{i,i+1} &amp;= - F, \quad i = 1, \dots, N_x - 1.
\end{aligned}
\end{split}\]</div>
<p>Αυτά τα στοιχεία καθιστούν εύκολη την αντιστροφή του πίνακα <span class="math notranslate nohighlight">\(A\)</span> και, ως εκ τούτου, την επίλυση του συστήματος των εξισώσεων. Αν θεωρήσουμε και ομογενείς, μηδενικές, συνοριακές συνθήκες, δηλαδή <span class="math notranslate nohighlight">\(u_0^n = 0, u_{N_x}^n = 0\)</span>, τότε έχουμε ότι,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-10">
<span class="eqno">(104)<a class="headerlink" href="#equation-eq-k4-10" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
a_{0,0} &amp;= 1, \\
a_{0,1} &amp;= 0, \\
a_{N_x,N_{x-1}} &amp;= 0, \\
a_{N_x,N_x} &amp;= 1.
\end{aligned}
\end{split}\]</div>
<p>Το διάνυσμα, <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, του δεξιού μέλους των εξισώσεων, είναι,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-11">
<span class="eqno">(105)<a class="headerlink" href="#equation-eq-k4-11" title="Link to this equation">#</a></span>\[
\mathbf{b} = (b_0, b_1, ..., b_i, ..., b_{N_x})^T
\]</div>
<p>με</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-12">
<span class="eqno">(106)<a class="headerlink" href="#equation-eq-k4-12" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
b_0 &amp;= 0, \\
b_i &amp;= u_i^{n-1}, \quad i = 1, \dots, N_x - 1, \\
b_{N_x} &amp;= 0.
\end{aligned}
\end{split}\]</div>
<p>Παρατηρούμε ότι ο πίνακας <span class="math notranslate nohighlight">\(A\)</span> περιέχει ποσότητες που δεν αλλάζουν στο χρόνο. Επομένως, ο πίνακας <span class="math notranslate nohighlight">\(A\)</span> μπορεί να σχηματιστεί μια για πάντα πριν τη χρονική εξέλιξη. Το δεξί μέλος <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, ωστόσο, πρέπει να ενημερώνεται σε κάθε χρονικό βήμα. Αυτό οδηγεί στον ακόλουθο υπολογιστικό αλγόριθμο, που σκιαγραφείται εδώ με κώδικα σε γλώσσα προγραμματισμού Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="c1"># χρησιμοποιούμε το πακέτο scipy για την επίλυση γραμμικών συστημάτων</span>

<span class="k">def</span> <span class="nf">solve_diffusion1D_BE</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Επιλύει τη μονοδιάστατη εξίσωση διάχυσης με το πεπλεγμένο σχήμα Euler (Backward Euler, BE) </span>
<span class="sd">    L: μήκος χωρίου στη διάσταση x</span>
<span class="sd">    Τ: τελική χρονική στιγμή</span>
<span class="sd">    dx: χωρικό βήμα</span>
<span class="sd">    dt: χρονικό βήμα</span>
<span class="sd">    d: συντελεστής διάχυσης</span>
<span class="sd">    I: συνάρτηση που επιστρέφει την αρχική συνθήκη (π.χ. gauss ή plug_profile).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="c1"># πεδίο ορισμού</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    
    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    
    <span class="n">u0</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="c1"># τρέχον χρονικό βήμα</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># αρχικοποίηση πινάκων Α και b.</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">F</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">F</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">F</span>

    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Α[0,0] = Α[Nx, Nx] = 0</span>
    <span class="c1"># Σύμφωνα με το αριθμητικό σχήμα, θα πρέπει να μηδενιστούν τα στοιχεία A[0,1] και Α[Nx, Nx-1]. </span>
    <span class="c1"># Ωστόσο έχει ήδη γίνει κατά την αρχικοποίηση του πίνακα Α με μηδενικά.</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">plot_freq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nsteps</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Υπολογισμός του πίνακα b και επίλυση γραμμικού συστήματος</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">u0</span> <span class="o">=</span> <span class="n">u</span>
    
        <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">plot_freq</span> == 0:
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="n">n</span><span class="o">*</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Στο <a class="reference internal" href="#fig-implicit-euler1"><span class="std std-numref">Σχήμα 13</span></a> παρουσιάζεται ένα παράδειγμα επίλυσης της μονοδιάστατης εξίσωσης διάχυσης με πεπλεγμένο σχήμα Euler, όπου η αρχική συνθήκη ορίζεται μέσω της συνάρτησης Gauss.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">solve_diffusion1D_BE</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">gauss</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-implicit-euler1">
<a class="reference internal image-reference" href="_images/implicit_Euler_1.svg"><img alt="_images/implicit_Euler_1.svg" src="_images/implicit_Euler_1.svg" style="width: 516.1px; height: 261.3px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Eπίλυση της μονοδιάστατης εξίσωσης διάχυσης με άμεσο σχήμα Euler. Η αρχική συνθήκη ορίζεται μέσω της συνάρτησης Gauss.</span><a class="headerlink" href="#fig-implicit-euler1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Στο <a class="reference internal" href="#fig-implicit-euler2"><span class="std std-numref">Σχήμα 14</span></a> παρουσιάζεται ένα παράδειγμα επίλυσης της μονοδιάστατης εξίσωσης διάχυσης με πεπλεγμένο σχήμα Euler, όπου η αρχική συνθήκη ορίζεται μέσω της συνάρτησης plug_profile.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> 
<span class="n">solve_diffusion1D_BE</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">plug_profile</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-implicit-euler2">
<a class="reference internal image-reference" href="_images/implicit_Euler_2.svg"><img alt="_images/implicit_Euler_2.svg" src="_images/implicit_Euler_2.svg" style="width: 516.1px; height: 261.3px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Eπίλυση της μονοδιάστατης εξίσωσης διάχυσης με άμεσο σχήμα Euler. Η αρχική συνθήκη ορίζεται μέσω της συνάρτησης plug_profile.</span><a class="headerlink" href="#fig-implicit-euler2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="note admonition">
<p class="admonition-title">Σημείωση</p>
<p>Οι μέθοδοι διακριτοποίησης που οδηγούν σε ένα συζευγμένο σύστημα εξισώσεων για την άγνωστη συνάρτηση στο νέο χρονικό βήμα λέγονται <strong>πεπελεγμένες μέθοδοι</strong>. Αντίστοιχα, ο όρος <strong>άμεσες μέθοδοι</strong> αναφέρεται σε μεθόδους διακριτοποίησης όπου υπάρχει ένας απλός σαφής τύπος για τις τιμές της άγνωστης συνάρτησης σε καθένα από τα χωρικά σημεία του πλέγματος στο νέο χρονικό βήμα ολοκλήρωσης. Από άποψη υλοποίησης, οι πεπλεγμένες μέθοδοι είναι πιο δύσκολες στην υλοποίηση αριθμητικού κώδικα, αφού χρειάζεται η επίλυση ενός συζευγμένου συστήματος εξισώσεων της μορφής <span class="math notranslate nohighlight">\(A \, \mathbf{u} = \mathbf{b}\)</span>, όπου <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> είναι το διάνυσμα των αγνώστων, <span class="math notranslate nohighlight">\(A\)</span> είναι ο πίνακας των συντελεστών και <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> είναι το διάνυσμα του δεξιού μέλους κάθε εξίσωσης. Για τις άμεσες μεθόδους είναι πιο εύκολη η υλοποίηση αριθμητικού κώδικα, αφού έχουμε μια απλή επαναληπτική διαδικασία.</p>
</div>
</section>
<section id="crank-nicolson">
<h2>Το σχήμα των Crank-Nicolson<a class="headerlink" href="#crank-nicolson" title="Link to this heading">#</a></h2>
<p>Η ιδέα για το σχήμα των Crank–Nicolson είναι να εφαρμοστούν κεντρικές πεπερασμένες διαφορές στο χώρο και το χρόνο, σε συνδυασμό με τη μέση τιμή του ενδιάμεσου (εικονικού) σημείου στο χρόνο. Σε αυτή τη μέθοδο απαιτούμε η διακριτή μορφή της Μ.Δ.Ε. να ισχύει σε εικονικά (ενδιάμεσα) χρονικά σημεία του υπολογιστικού πλέγματος <span id="id7">[<a class="reference internal" href="zreferences.html#id12" title="Νικόλαος Καφούσιας. Υπολογιστική ρευστοδυναμική ΙΙ. Εκδόσεις Πανεπιστημίου Πάτρας, Πάτρα, 2001.">Καφούσιας, 2001</a>]</span>. Πιο συγκεκριμένα,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-13">
<span class="eqno">(107)<a class="headerlink" href="#equation-eq-k4-13" title="Link to this equation">#</a></span>\[
\frac{\partial}{\partial t} u(x_i, t_{n+\frac{1}{2}}) = d \, \frac{\partial^2}{\partial x^2} u(x_i, t_{n+\frac{1}{2}}), \qquad i = 0, ..., N_x - 1, \qquad n = 0, ..., N_t - 1.  
\]</div>
<p>Εφαρμόζοντας κεντρικές διαφορές για τις χωρικές και τις χρονικές μεταβλητές στο δεξιό μέλος της εξίσωσης, έχουμε την έκφραση,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-14">
<span class="eqno">(108)<a class="headerlink" href="#equation-eq-k4-14" title="Link to this equation">#</a></span>\[
\frac{1}{\Delta x^2} \left( u_{i-1}^{n+\frac{1}{2}} - 2 u_{i}^{n+\frac{1}{2}} + u_{i+1}^{n+\frac{1}{2}} \right).
\]</div>
<p>Αυτή η έκφραση περιγράφει την τιμή της άγνωστης συνάρτησης <span class="math notranslate nohighlight">\(u\)</span> σε ένα εικονικό (μη υπαρκτό) σημείο της διαμέρισης, π.χ. <span class="math notranslate nohighlight">\(u_{i}^{n+\frac{1}{2}}\)</span>. Η πιο απλή αντικατάσταση που μπορούμε να κάνουμε είναι η αντικατάσταση με τη μέση τιμή της <span class="math notranslate nohighlight">\(u\)</span> στα γειτονικά γνωστά σημεία της διαμέρισης,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-15a">
<span class="eqno">(109)<a class="headerlink" href="#equation-eq-k4-15a" title="Link to this equation">#</a></span>\[
u_{i}^{n+\frac{1}{2}} \approx \frac{1}{2} (u_{i}^{n} + u_{i}^{n+1}).
\]</div>
<p>Τελικά, εφαρμόζοντας τη διαδικασία διακριτοποίησης και αντικαθιστώντας με το μέση τιμή για τα εικονικά σημεία, πολλαπλασιάζοντας επί <span class="math notranslate nohighlight">\(\Delta t\)</span> και ομαδοποιώντας τους όρους έχουμε ότι,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-15b">
<span class="eqno">(110)<a class="headerlink" href="#equation-eq-k4-15b" title="Link to this equation">#</a></span>\[
u_{i}^{n+1} - \frac{1}{2} F \left( u_{i-1}^{n+1} - 2 u_{i}^{n+1} + u_{i+1}^{n+1} \right) = u_{i}^{n} + \frac{1}{2} F \left( u_{i-1}^{n} - 2 u_{i}^{n} + u_{i+1}^{n} \right),
\]</div>
<p>όπου η παράμετρος <span class="math notranslate nohighlight">\(F = \frac{d \, \Delta t}{\Delta x^2}\)</span>, ορίζεται όπως και στην προηγούμενη ενότητα. Το αλγεβρικό σύστημα που προκύπτει από τη διακριτοποίηση περιλαμβάνει τους αγνώστους, <span class="math notranslate nohighlight">\(u_{i-1}^{n+1}\)</span>, <span class="math notranslate nohighlight">\(u_{i}^{n+1}\)</span> και <span class="math notranslate nohighlight">\(u_{i+1}^{n+1}\)</span> και αποτελεί ένα συζευγμένο γραμμικό σύστημα της μορφής <span class="math notranslate nohighlight">\(A \, \mathbf{u} = \mathbf{b}\)</span>, όπου <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> είναι το διάνυσμα των αγνώστων, <span class="math notranslate nohighlight">\(A\)</span> είναι ο πίνακας των συντελεστών και <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> είναι το διάνυσμα του δεξιού μέλους κάθε εξίσωσης. Ο πίνακας <span class="math notranslate nohighlight">\(A\)</span> είναι παρόμοιας μορφής με αυτή που περιγράψαμε στην προηγούμενη ενότητα, δηλαδή τριδιαγώνιος πίνακας με όρους,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-16">
<span class="eqno">(111)<a class="headerlink" href="#equation-eq-k4-16" title="Link to this equation">#</a></span>\[
a_{i,i-1} = - \frac{1}{2} F, \,\, a_{i,i} = \frac{1}{2} + F, \,\, a_{i,i+1} = - \frac{1}{2} F, \,\,\, i = 1, ..., N_x - 1.
\]</div>
<p>Αυτά τα στοιχεία καθιστούν εύκολη την αντιστροφή του πίνακα <span class="math notranslate nohighlight">\(A\)</span> και, ως εκ τούτου, την επίλυση του συστήματος των εξισώσεων. Αν θεωρήσουμε και ομογενείς, μηδενικές, συνοριακές συνθήκες, δηλαδή <span class="math notranslate nohighlight">\(u_0^n = 0\)</span>, <span class="math notranslate nohighlight">\(u_{N_x}^n = 0\)</span>, τότε έχουμε ότι,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-17">
<span class="eqno">(112)<a class="headerlink" href="#equation-eq-k4-17" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
a_{0,0} &amp;= 1, \\
a_{0,1} &amp;= 0, \\
a_{N_x,N_{x-1}} &amp;= 0, \\
a_{N_x,N_x} &amp;= 1.
\end{aligned}
\end{split}\]</div>
<p>Το διάνυσμα <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> του δεξιού μέλους των εξισώσεων, είναι,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-18">
<span class="eqno">(113)<a class="headerlink" href="#equation-eq-k4-18" title="Link to this equation">#</a></span>\[
\mathbf{b} = (b_0, b_1, ..., b_i, ..., b_{N_x})^T
\]</div>
<p>με</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-19">
<span class="eqno">(114)<a class="headerlink" href="#equation-eq-k4-19" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
b_0 &amp;= 0, \\
b_i &amp;= u_i^{n-1}, \quad i = 1, \dots, N_x - 1, \\
b_{N_x} &amp;= 0.
\end{aligned}
\end{split}\]</div>
<p>Ο παρακάτω κώδικας εφαρμόζει τη μέθοδο Crank–Nicolson για την επίλυση της μονοδιάστατης εξίσωσης διάχυσης.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.linalg</span>

<span class="k">def</span> <span class="nf">solve_diffusion1D_CR</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Επιλύει τη μονοδιάστατη διάχυση με το σχήμα Crank-Nicolson (CR)</span>
<span class="sd">    L: μήκος χωρίου στη διάσταση x</span>
<span class="sd">    Τ: τελική χρονική στιγμή</span>
<span class="sd">    dx: χωρικό βήμα</span>
<span class="sd">    dt: χρονικό βήμα</span>
<span class="sd">    d: συντελεστής διάχυσης</span>
<span class="sd">    I: συνάρτηση που επιστρέφει την αρχική συνθήκη (π.χ. gauss ή plug_profile).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="c1"># πεδίο ορισμού</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    
    
    <span class="n">u0</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="c1"># τρέχον χρονικό βήμα</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># αρχικοποίηση πινάκων Α και b.</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">F</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">F</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">F</span><span class="o">/</span><span class="mi">2</span>

    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">plot_freq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nsteps</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

        <span class="n">u0</span> <span class="o">=</span> <span class="n">u</span>
    
        <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">plot_freq</span> == 0:
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="n">n</span><span class="o">*</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Στο<a class="reference internal" href="#fig-cr1"><span class="std std-numref">Σχήμα 15</span></a> παρουσιάζεται ένα παράδειγμα επίλυσης της μονοδιάστατης εξίσωσης διάχυσης με το σχήμα Crank–Nicolson. Η αρχική συνθήκη ορίζεται μέσω της συνάρτησης γauss.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">solve_diffusion1D_CR</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">gauss</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-cr1">
<a class="reference internal image-reference" href="_images/CR_1.svg"><img alt="_images/CR_1.svg" src="_images/CR_1.svg" style="width: 516.1px; height: 261.3px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Eπίλυση της μονοδιάστατης εξίσωσης διάχυσης με το σχήμα Crank–Nicolson. Η αρχική συνθήκη ορίζεται μέσω της συνάρτησης gauss.</span><a class="headerlink" href="#fig-cr1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Στο <a class="reference internal" href="#fig-cr2"><span class="std std-numref">Σχήμα 16</span></a> παρουσιάζεται ένα παράδειγμα επίλυσης της μονοδιάστατης εξίσωσης διάχυσης με το σχήμα Crank–Nicolson. Η αρχική συνθήκη ορίζεται μέσω της συνάρτησης plug_profile.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> 
<span class="n">solve_diffusion1D_CR</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">plug_profile</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-cr2">
<a class="reference internal image-reference" href="_images/CR_2.svg"><img alt="_images/CR_2.svg" src="_images/CR_2.svg" style="width: 516.1px; height: 261.3px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">Eπίλυση της μονοδιάστατης εξίσωσης διάχυσης με το σχήμα Crank–Nicolson. Η αρχική συνθήκη ορίζεται μέσω της συνάρτησης plug_profile
``</span><a class="headerlink" href="#fig-cr2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="theta">
<h2>Ο κανόνας του <span class="math notranslate nohighlight">\(\theta\)</span><a class="headerlink" href="#theta" title="Link to this heading">#</a></h2>
<p>Ο κανόνας του <span class="math notranslate nohighlight">\(\theta\)</span> αποτελεί τη γενίκευση των προηγούμενων μεθόδων που εισάγονται σε αυτό το κεφάλαιo, όπως είναι η εμπρόσθια και η οπίσθια μέθοδος του Euler και η μέθοδος των Crank–Nicolson. Για μια εξίσωση της μορφής,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-20">
<span class="eqno">(115)<a class="headerlink" href="#equation-eq-k4-20" title="Link to this equation">#</a></span>\[
\frac{\partial u}{\partial t} = G(u), 
\]</div>
<p>όπου το <span class="math notranslate nohighlight">\(G(\cdot)\)</span> είναι ένας χωρικός διαφορικός τελεστής που δρα στη συνάρτηση <span class="math notranslate nohighlight">\(u\)</span>, ο κανόνας του <span class="math notranslate nohighlight">\(\theta\)</span> είναι της μορφής,</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-20-theta">
<span class="eqno">(116)<a class="headerlink" href="#equation-eq-k4-20-theta" title="Link to this equation">#</a></span>\[
\frac{u_i^{n+1} - u_i^{n}}{\Delta t} = \theta G(u_i^{n+1}) + (1 - \theta) G(u_i^{n}) .
\]</div>
<p>Το σημαντικό χαρακτηριστικό του αριθμητικού σχήματος <span class="math notranslate nohighlight">\(\theta\)</span> είναι ότι αποτελεί μία γενικότερη οικογένεια γνωστών και ευρέως χρησιμοποιούμενων σχημάτων χρονικής διακριτοποίησης. Οπότε, για διάφορες τιμές του <span class="math notranslate nohighlight">\(\theta\)</span> μπορούμε να πάρουμε τα παρακάτω αριθμητικά σχήματα:</p>
<ol class="arabic simple">
<li><p>Όταν <span class="math notranslate nohighlight">\(\theta = 0\)</span>, παίρνουμε το άμεσο αριθμητικό σχήμα του Euler στο χρόνο.</p></li>
<li><p>Όταν <span class="math notranslate nohighlight">\(\theta = 1\)</span>, παίρνουμε το πεπλεγμένο αριθμητικό σχήμα του Euler στο χρόνο.</p></li>
<li><p>Όταν <span class="math notranslate nohighlight">\(\theta = 1/2\)</span>, παίρνουμε το πεπλεγμένο αριθμητικό σχήμα των Crank–Nicolson στο χρόνο.</p></li>
</ol>
<p>Αν εφαρμόσουμε στο πρόβλημα της μονοδιάστατης εξίσωσης διάχυσης τον κανόνα <span class="math notranslate nohighlight">\(\theta\)</span> παίρνουμε το παρακάτω αριθμητικό σχήμα:</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-21">
<span class="eqno">(117)<a class="headerlink" href="#equation-eq-k4-21" title="Link to this equation">#</a></span>\[
\frac{u_i^{n+1} - u_i^{n}}{\Delta t} = d \left( \theta \, \frac{u_{i+1}^{n+1} - 2 u_i^{n+1} + u_{i-1}^{n+1}}{\Delta x^2} + (1 - \theta) \, \frac{u_{i+1}^{n} - 2 u_i^{n} + u_{i-1}^{n}}{\Delta x^2} \right).
\]</div>
<p>Αυτό το αριθμητικό σχήμα οδηγεί σε ένα αλγεβρικό σύστημα, όπου ο πίνακας των συντελεστών <span class="math notranslate nohighlight">\(A\)</span> είναι τριδιαγώνιος και έχει τις παρακάτω συνιστώσες:</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-22">
<span class="eqno">(118)<a class="headerlink" href="#equation-eq-k4-22" title="Link to this equation">#</a></span>\[\begin{split}
\begin{aligned}
a_{i,i-1} &amp;= - F \, \theta, \\
a_{i,i}   &amp;= 1 + 2 \, F \, \theta, \\
a_{i,i+1} &amp;= - F \, \theta, \quad i = 1, \dots, N_x - 1.
\end{aligned}
\end{split}\]</div>
<p>Το διάνυσμα <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> του δεξιού μέλους των εξισώσεων έχει συνιστώσες της μορφής:</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-23">
<span class="eqno">(119)<a class="headerlink" href="#equation-eq-k4-23" title="Link to this equation">#</a></span>\[
b_i  = u_i^{n} + F \, (1 - \theta) \, \frac{u_{i+1}^{n} - 2 u_i^{n} + u_{i-1}^{n}}{\Delta x^2}.
\]</div>
<p>Οι αντίστοιχες τιμές για τα συνοριακά σημεία είναι ίδιες όπως και στα πεπλεγμένα σχήματα της οπίσθιας μεθόδου του Euler και της μεθόδου των Crank–Nicolson, που έχουμε περιγράψει στις προηγούμενες ενότητες. Ακολουθεί η υλοποίηση του κανόνα <span class="math notranslate nohighlight">\(\theta\)</span> για την επίλυση της μονοδιάστατης εξίσωσης διάχυσης.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.linalg</span>

<span class="k">def</span> <span class="nf">tridiag</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="n">a</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="n">c</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">theta_rule_diffusion1D</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="c1"># πεδίο ορισμού</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    
    <span class="n">u0</span> <span class="o">=</span> <span class="n">I</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="c1"># τρέχον χρονικό βήμα</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="p">(</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span> <span class="n">F</span> <span class="o">*</span> <span class="n">theta</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">F</span> <span class="o">*</span> <span class="n">theta</span>
    <span class="n">c</span> <span class="o">=</span> <span class="o">-</span> <span class="n">F</span> <span class="o">*</span> <span class="n">theta</span>
    
    <span class="n">A</span> <span class="o">=</span> <span class="n">tridiag</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">plot_freq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nsteps</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">xi</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

        <span class="n">u0</span> <span class="o">=</span> <span class="n">u</span>
    
        <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">plot_freq</span> == 0:
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="n">n</span><span class="o">*</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="du-fort-frankel">
<h2>Ο τύπος των Du Fort-Frankel και η μέθοδος εμπρόσθιων διαφορών<a class="headerlink" href="#du-fort-frankel" title="Link to this heading">#</a></h2>
<p>Στις προηγούμενες ενότητες αναπτύξαμε το άμεσο αριθμητικό σχήμα του Euler. Αυτό το αριθμητικό σχήμα γράφεται στη μορφή:</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-24">
<span class="eqno">(120)<a class="headerlink" href="#equation-eq-k4-24" title="Link to this equation">#</a></span>\[
u_i^{n+1} = u_i^n + \frac{d \, \Delta t}{\Delta x^2} (u_{i+1}^{n} - 2 \, u_i^n + u_{i-1}^n).
\]</div>
<p>Όπου η παράμετρος <span class="math notranslate nohighlight">\(F = \frac{d \, \Delta t}{\Delta x^2}\)</span> είναι βασική παράμετρος για την εξίσωση διάχυσης. Η <span class="math notranslate nohighlight">\(F\)</span>, όπως έχουμε ήδη περιγράψει, είναι ένας αδιάστατος αριθμός που περιλαμβάνει σε μία μόνο παράμετρο τη βασική φυσική παράμετρο του προβλήματος, <span class="math notranslate nohighlight">\(d\)</span>, καθώς και τις παραμέτρους διακριτοποίησης, <span class="math notranslate nohighlight">\(\Delta x\)</span> και <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>Στο ανωτέρω αριθμητικό σχήμα χρησιμοποιήσαμε κεντρικές διαφορές για τις χωρικές παραγώγους και εμπρόσθιες διαφορές για τις χρονικές. Έτσι το σφάλμα αποκοπής είναι <span class="math notranslate nohighlight">\(O(\Delta t, \Delta x^2)\)</span>.</p>
<p>Ένα βελτιωμένο αριθμητικό σχήμα, με σφάλμα αποκοπής <span class="math notranslate nohighlight">\(O(\Delta t^2, \Delta x^2)\)</span> επιτυγχάνεται με χρήση κεντρικών διαφορών τόσο για τις χωρικές όσο και για τις χρονικές παραγώγους. Στη συνέχεια αντικαθιστούμε το δεύτερο <span class="math notranslate nohighlight">\(u_i^n\)</span> στο δεύτερο μέλος της εξίσωσης <a class="reference internal" href="#equation-eq-k4-24">(120)</a>, με τη μέση τιμή του, δηλαδή <span class="math notranslate nohighlight">\(\frac{u_i^{n+1} + u_i^{n-1}}{2}\)</span>.</p>
<p>Έτσι το βελτιωμένο αριθμητικό σχήμα που παίρνουμε έχει την παρακάτω μορφή:</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-25">
<span class="eqno">(121)<a class="headerlink" href="#equation-eq-k4-25" title="Link to this equation">#</a></span>\[
\frac{u_i^{n+1} - u_i^{n-1}}{2 \, \Delta t} + \frac{d}{\Delta x^2} (u_{i-1}^{n} - u_{i}^{n-1} - u_i^{n+1} + u_{i+1}^n).
\]</div>
<p>Ή, τελικά, έχουμε ότι:</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-26">
<span class="eqno">(122)<a class="headerlink" href="#equation-eq-k4-26" title="Link to this equation">#</a></span>\[
(1 + 2 \, F) \, u_i^{n+1} = 2 \, F \, (u_{i-1}^{n} + u_{i+1}^n) + (1 - 2 \, F) \, u_{i}^{n-1}.
\]</div>
<p>Η εξίσωση <a class="reference internal" href="#equation-eq-k4-26">(122)</a> αποτελεί την εξίσωση των Du Fort–Frankel <span id="id8">[<a class="reference internal" href="zreferences.html#id25" title="E.C. Du Fort and S.P. Frankel. Stability conditions in the numerical treatment of parabolic differential equations. Mathematical Tables and other Aids to Computation, 7(43):135–152, 1953.">Du Fort and Frankel, 1953</a>]</span>.</p>
<p>Ο παραπάνω τύπος περιλαμβάνει τρία χρονικά επίπεδα, <span class="math notranslate nohighlight">\((n+1 , n , n-1)\)</span> και αποδεικνύεται ότι έχει σφάλμα αποκοπής <span class="math notranslate nohighlight">\(O(\Delta t, \Delta x^2)\)</span>. Πρόκειται, επίσης, για ένα αριθμητικό σχήμα που είναι ευσταθές άνευ συνθηκών (unconditionally stable numerical scheme).</p>
<p>Σύμφωνα με το αριθμητικό σχήμα <a class="reference internal" href="#equation-eq-k4-24">(120)</a>, ο υπολογισμός της λύσης στο σημείο <span class="math notranslate nohighlight">\((i, n+1)\)</span>, δηλαδή στο επόμενο χρονικό βήμα, απαιτεί την τιμή της λύσης σε τρία σημεία του πλέγματος του προηγούμενου χρονικού βήματος, <span class="math notranslate nohighlight">\(n\)</span>, δηλαδή στα σημεία <span class="math notranslate nohighlight">\((i-1, n)\)</span>, <span class="math notranslate nohighlight">\((i, n)\)</span> και <span class="math notranslate nohighlight">\((i+1, n)\)</span>. Με τον ίδιο τρόπο ο υπολογισμός της λύσης στο σημείο <span class="math notranslate nohighlight">\((i-1, n)\)</span>, απαιτεί την τιμή της λύσης και στο σημείο <span class="math notranslate nohighlight">\((i-2, n)\)</span>, κ.λπ.</p>
<figure class="align-default" id="fig-fd-bw">
<img alt="_images/FD_backward.svg" src="_images/FD_backward.svg" />
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">Υπολογισμός της τιμής της συνάρτησης στο σημείο <span class="math notranslate nohighlight">\((i, n+1)\)</span> για το πεπλεγμένο σχήμα των οπίσθιων διαφορών.</span><a class="headerlink" href="#fig-fd-bw" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Άρα, η τιμή της λύσης στο σημείο <span class="math notranslate nohighlight">\(A \, (i, n+1)\)</span> εξαρτάται από την τιμή της λύσης σε όλα τα σημεία του πλέγματος που ορίζει το τρίγωνο <span class="math notranslate nohighlight">\(OAB\)</span>, όχι όμως και απ’ όλα τα σημεία του πλέγματος που βρίσκονται κάτω από την ευθεία <span class="math notranslate nohighlight">\(t = n + 1\)</span>, όπως χαρακτηριστικά φαίνεται στο <a class="reference internal" href="#fig-fd-bw"><span class="std std-numref">Σχήμα 17</span></a>. Αυτό σημαίνει ότι το παραπάνω αριθμητικό σχήμα θα είναι καλύτερο, όσο περισσότερα σημεία του πλέγματος περιλαμβάνονται μέσα στο τρίγωνο <span class="math notranslate nohighlight">\(OAB\)</span>. Αυτό επιτυγχάνεται για πιο εκλεπτυσμένο χρονικό βήμα <span class="math notranslate nohighlight">\(k\)</span>, δηλαδή με αύξηση του υπολογιστικού χρόνου.</p>
<div class="note admonition">
<p class="admonition-title">Σημείωση</p>
<p>Παρατηρούμε ότι το αριθμητικό σχήμα των Du Fort–Frankel είναι ένα βελτιωμένο αριθμητικό σχήμα, σε σχέση με το άμεσο αριθμητικό σχήμα του Euler, που είναι ακρίβειας <span class="math notranslate nohighlight">\(O(\Delta t, \Delta x^2)\)</span>. Η σχέση όμως <a class="reference internal" href="#equation-eq-k4-26">(122)</a> του τύπου των Du Fort–Frankel δεν έχει τον άμεσο χαρακτήρα του προηγούμενου αριθμητικού σχήματος. Για το λόγο αυτό και η εφαρμογή του σε Η/Υ δεν έχει την ίδια απλότητα που είχε το σχήμα των εμπρόσθιων διαφορών.</p>
</div>
</section>
<section id="id9">
<h2>Επέκταση στις δύο διαστάσεις<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<p>Η εξίσωση διάχυσης σε 2 διαστάσεις είναι:</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-27">
<span class="eqno">(123)<a class="headerlink" href="#equation-eq-k4-27" title="Link to this equation">#</a></span>\[
\frac{\partial u}{\partial t} = d \left(\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}\right).
\]</div>
<p>Εφαρμόζοντας το άμεσο σχήμα Euler για τη διακριτοποίηση της <a class="reference internal" href="#equation-eq-k4-27">(123)</a> έχουμε,</p>
<div class="math notranslate nohighlight">
\[
\frac{u_{i,j}^{n+1} - u_{i,j}^n}{\Delta t} = d \, \left(\frac{u_{{i+1,j}}^{n} - 2 u_{i,j}^n + u_{i-1,j}^n}{\Delta x^2} + \frac{u_{{i,j+1}}^{n} - 2 u_{i,j}^n + u_{i,j-1}^n}{\Delta y^2}\right)
\]</div>
<p>Με αναδιάταξη των όρων, η άγνωστη συνάρτηση βρίσκεται ως εξής:</p>
<div class="math notranslate nohighlight" id="equation-eq-k4-28">
<span class="eqno">(124)<a class="headerlink" href="#equation-eq-k4-28" title="Link to this equation">#</a></span>\[
u_{i,j}^{n+1} = u_{i,j}^n + d \Delta t \, \left(\frac{u_{{i+1,j}}^{n} - 2 u_{i,j}^n + u_{i-1,j}^n}{\Delta x^2} + \frac{u_{{i,j+1}}^{n} - 2 u_{i,j}^n + u_{i,j-1}^n}{\Delta y^2}\right) .
\]</div>
<p>Στο παράδειγμα που ακολουθεί, επιλύεται η εξίσωση διάχυσης σε ένα τετραγωνικό χωρίο με την παραδοχή ότι η συνάρτηση παίρνει την τιμή 1 εντός ενός κύκλου με ακτίνα <span class="math notranslate nohighlight">\(r\)</span> και κέντρο <span class="math notranslate nohighlight">\((cx, cy)\)</span>, ενώ εκτός του κύκλου έχει την τιμή 0. Μία αναπαράσταση της λύσης παρουσιάζεται στο <a class="reference internal" href="#fig-df2d"><span class="std std-numref">Σχήμα 18</span></a>.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">do_timestep</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="c1"># εμπρόσθιες διαφορές στο χρόνο, κεντρικές διαφορές στο χώρο</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u0</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span>
          <span class="p">(</span><span class="n">u0</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u0</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u0</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">dx2</span>
          <span class="o">+</span> <span class="p">(</span><span class="n">u0</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u0</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u0</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">dy2</span> <span class="p">)</span>

    <span class="n">u0</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">u0</span><span class="p">,</span> <span class="n">u</span>

 
<span class="n">Lx</span> <span class="o">=</span> <span class="n">Ly</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">dx</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">4.</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="mi">101</span>

<span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Lx</span><span class="o">/</span><span class="n">dx</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">Ly</span><span class="o">/</span><span class="n">dy</span><span class="p">)</span>

<span class="n">dx2</span><span class="p">,</span> <span class="n">dy2</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dx2</span> <span class="o">*</span> <span class="n">dy2</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">dx2</span> <span class="o">+</span> <span class="n">dy2</span><span class="p">))</span> <span class="c1"># το μέγιστο dt ώστε το σχήμα να παραμένει ευσταθές (F=0.5)</span>

<span class="n">u0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">u0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># αρχική συνθήκη - κύκλος ακτίνας r και με κέντρο (cx,cy)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="p">):</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">dx</span><span class="o">-</span><span class="n">cx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">dy</span><span class="o">-</span><span class="n">cy</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">p2</span> <span class="o">&lt;</span> <span class="n">r2</span><span class="p">:</span>
            <span class="n">u0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># χρονικά σημεία</span>

<span class="n">plot_timings</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_timings</span><span class="p">),</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>

<span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>
    <span class="n">u0</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">do_timestep</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">plot_timings</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;afmhot&#39;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;t = </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-df2d">
<a class="reference internal image-reference" href="_images/Difussion_2D.svg"><img alt="_images/Difussion_2D.svg" src="_images/Difussion_2D.svg" style="width: 604.5px; height: 180.70000000000002px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">Επίλυση της εξίσωσης διάχυσης σε τετραγωνικό χωρίο.</span><a class="headerlink" href="#fig-df2d" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="tip admonition">
<p class="admonition-title">Ασκήσεις για λύση</p>
<ol class="arabic simple">
<li><p>Να γραφεί πρόγραμμα για το άμεσο και το πεπλεγμένο σχήμα του Euler με βάση τον αριθμό των σημείων διακριτοποίησης αντί για το χωρικό βήμα που δίνεται παραπάνω.</p></li>
<li><p>Να γραφούν τα προγράμματα του άμεσου και του πεπλεγμένου σχήματος του Euler καθώς και του σχήματος των Crank–Nicolson για εναλλακτικές συνοριακές συνθήκες.</p></li>
<li><p>Να γραφεί ο κώδικας για το πρόβλημα της διάχυσης σε 2 διαστάσεις σε μορφή συνάρτησης με τα κατάλληλα ορίσματα.</p></li>
<li><p>Να γραφεί ο κώδικας για το πρόβλημα της διάχυσης σε 2 διαστάσεις με ένα πεπλεγμένο αριθμητικό σχήμα.</p></li>
<li><p>Να δοθεί κώδικας επίλυσης της εξίσωσης διάχυσης με το άμεσο σχήμα του Euler σε 3 διαστάσεις.</p></li>
</ol>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "raptistasos/CFD_python_GR",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Βασικές αριθμητικές μέθοδοι για προβλήματα Ρευστοδυναμικής</p>
      </div>
    </a>
    <a class="right-next"
       href="Chapter5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Οι εξισώσεις Laplace και Poisson</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Περίληψη</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Η εξίσωση διάχυσης σε μία χωρική διάσταση</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Το πρόβλημα αρχικών-συνοριακών τιμών για την εξίσωση διάχυσης σε μία διάσταση</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crank-nicolson">Το σχήμα των Crank-Nicolson</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theta">Ο κανόνας του <span class="math notranslate nohighlight">\(\theta\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#du-fort-frankel">Ο τύπος των Du Fort-Frankel και η μέθοδος εμπρόσθιων διαφορών</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Επέκταση στις δύο διαστάσεις</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Αναστάσιος Ράπτης και Μιχαήλ Ξένος
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>